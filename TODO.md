# FastMovieMaker TODO

## 🚧 진행 중 / In Progress

### 프레임 버퍼링 시스템 (Frame Buffering System)
**목표**: QMediaPlayer 소스 전환 지연 제거, 안정적인 멀티 소스 재생

**현재 문제점**:
- QMediaPlayer 소스 전환 시 200ms+ 지연 발생
- 멀티 소스 타임라인(A→B→A) 재생 시 끊김
- 클립 분할/삭제 후 플레이어 상태 불안정
- 영상 두 개 이상일 때 클립 분할 실패

**해결 방안**: 프레임 기반 플레이백
```
비디오 로드
  ↓
FFmpeg로 전체 프레임 추출 (30fps)
  ↓
디스크 캐시 저장 (JPEG, ~100MB/분)
  ↓
QGraphicsPixmapItem으로 프레임 표시
+ QMediaPlayer는 오디오만 재생
```

**구현 작업**:
- [ ] **Phase 1: VideoFramePlayer 서비스**
  - [ ] `src/services/video_frame_player.py` 생성
  - [ ] QTimer 기반 30fps 재생 로직
  - [ ] 프레임 캐시에서 프레임 로드
  - [ ] 멀티 소스 클립 경계 자동 전환
  - [ ] 재생/일시정지/스크럽 지원

- [ ] **Phase 2: 전체 프레임 추출**
  - [ ] `FrameCacheService.extract_frames()` 수정
    - 1초 간격 → 30fps (또는 사용자 설정 FPS)
    - 프레임 품질 옵션 (저/중/고)
  - [ ] 백그라운드 추출 진행률 표시
  - [ ] 추출 중 편집 가능 (부분 캐시 사용)

- [ ] **Phase 3: 오디오 동기화**
  - [ ] QMediaPlayer를 오디오 전용으로 전환
  - [ ] 프레임 타이머와 오디오 위치 동기화
  - [ ] 드리프트 보정 (±10ms 허용)

- [ ] **Phase 4: 메모리 최적화**
  - [ ] LRU 캐시 구현 (메모리에 최근 100프레임만 유지)
  - [ ] 백그라운드 프레임 프리로드 (재생 방향 예측)
  - [ ] 디스크 캐시 압축 옵션

- [ ] **Phase 5: UI 통합**
  - [ ] `main_window.py`에서 VideoFramePlayer 사용
  - [ ] 기존 QMediaPlayer 코드와 호환성 유지
  - [ ] 설정에서 "프레임 기반 재생" 토글 옵션

- [ ] **Phase 6: 테스트**
  - [ ] 멀티 소스 재생 테스트 (A→B→A→A→B 패턴)
  - [ ] 클립 분할/삭제 후 재생 테스트
  - [ ] 메모리 사용량 프로파일링
  - [ ] 30분+ 영상 성능 테스트

**예상 효과**:
- ✅ 소스 전환 지연 0ms (즉시)
- ✅ 멀티 소스 재생 완벽 안정화
- ✅ 프레임 단위 정확한 제어
- ✅ 클립 편집 후 재생 문제 해결
- ⚠️ 디스크 사용량 증가 (~100MB/분, 임시 파일)

---

## 🐛 현재 버그 수정

### 긴급 (Critical)
- [x] ~~멀티 소스 타임라인 재생 버그~~ (43개 테스트 통과)
- [x] ~~타임라인/슬라이더 동기화 문제~~ (수정 완료)
- [x] ~~클립 삭제 후 재생 문제~~ (플레이어 상태 초기화 추가)
- [ ] **영상 두 개 이상일 때 클립 분할 안 되는 문제** (디버그 로그 추가, 원인 파악 중)

### 중요 (High)
- [ ] TTS 다이얼로그 진행률 표시 테스트 실패 (12/13 통과)

### 보통 (Medium)
- [ ] 프레임 스냅 활성화 시 UI 피드백
- [ ] 대용량 프로젝트 로드 속도 개선

---

## 📋 백로그 / Backlog

### 기능 추가
- [ ] GPU 가속 비디오 렌더링
- [ ] 실시간 자막 프리뷰 (Whisper 진행 중)
- [ ] 플러그인 시스템 (커스텀 TTS 제공자)
- [ ] 클라우드 프로젝트 동기화
- [ ] AI 기반 자막 번역 (DeepL/GPT)

### 성능 개선
- [ ] 파이썬 코어 로직 Cython 변환
- [ ] 자막 렌더링 최적화
- [ ] 프로젝트 파일 압축

### 문서
- [x] ~~README.md 작성~~ (완료)
- [x] ~~TTS 사용 가이드 (한/영)~~ (완료)
- [x] ~~MIT License 추가~~ (완료)
- [ ] 개발자 가이드 (아키텍처, 기여 방법)
- [ ] 비디오 튜토리얼

---

## 📌 최근 완료 / Recently Completed

- ✅ 프레임 캐시 시스템 (스크럽 시 즉시 프리뷰) - 2026-02-09
- ✅ 멀티 소스 재생 버그 수정 (43개 테스트) - 2026-02-09
- ✅ README 및 문서 작성 - 2026-02-09
- ✅ TTS 사용 가이드 (한국어/영어) - 2026-02-09
- ✅ 클립 분할/삭제 피드백 개선 - 2026-02-09

---

**Last Updated**: 2026-02-09
